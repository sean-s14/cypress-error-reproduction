FROM cypress/browsers:node-20.16.0-chrome-127.0.6533.88-1-ff-128.0.3-edge-127.0.2651.74-1

ARG VAR
ARG VITE_VAR
ARG BASE_URL
ARG VITE_AUTH0_DOMAIN
ARG VITE_AUTH0_CLIENT_ID
ARG AUTH0_EMAIL
ARG AUTH0_PASSWORD

ENV VAR=$VAR
ENV VITE_VAR=$VITE_VAR
ENV BASE_URL=$BASE_URL
ENV VITE_AUTH0_DOMAIN=$VITE_AUTH0_DOMAIN
ENV VITE_AUTH0_CLIENT_ID=$VITE_AUTH0_CLIENT_ID
ENV AUTH0_EMAIL=$AUTH0_EMAIL
ENV AUTH0_PASSWORD=$AUTH0_PASSWORD

WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
EXPOSE 3000
RUN npm run build
CMD ["npm", "run", "preview", "--", "--host"]